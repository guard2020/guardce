### GUARD Platform (c) 2020
###
### agent:      aminer          guard-vdpi  lora-agent  pgafilter
### exec_env:   network-manager web-server  lora        backend-prod
### type
###   exec_env: bare-metal  container-docker    container-k8s   vm  cloud   application gateway mobile
###   network_link: multi-pnt   network-slice   pnt2pnt wifi    hosted

@uri = {{instance_agent_uri}}
@agent = aminer
@exec_env = network-manager
@action = start
@parameter = log
@parameter_value=10s

@id = {{agent}}@{{exec_env}}

###


### Get info
GET {{cb_manager_endpoint}}/{{uri}}

{
    "select": [],
    "where": {
        "equals": {
            "target": "id",
            "expr": "{{id}}"
        }
    }
}

### Catalog Info

GET {{cb_manager_endpoint}}/{{catalog_agent_uri}}

{
    "select": [],
    "where": {
        "equals": {
            "target": "id",
            "expr": "{{agent}}"
        }
    }
}


### Create

POST {{cb_manager_endpoint}}}/{{uri}}

{
    "id": "{{id}}",
    "exec_env_id": "{{exec_env}}",
    "agent_catalog_id": "{{agent}}",
    "status": "stopped"
}

### Execution action

PUT {{cb_manager_endpoint}}}/{{uri}}

{
    "id": "{{id}}",
    "operations": {
        "actions": {
            "id": "{{action}}"
        }
    }
}

### Update parameter

PUT {{cb_manager_endpoint}}}/{{uri}}

{
    "id": "{{id}}",
    "operations": {
        "paremters": {
            "id": "{{parameter}}",
            "value": "{{parameter_value}}"
        }
    }
}
