{
    "id": "aminer@aminer",
    "operations": [
        {
            "resources": [
                {
                    "id": "config-file",
                    "content": "LearnMode: False\nAminerUser: 'aminer'\nAminerGroup: 'aminer'\nLog.Encoding: 'latin-1'\nLogResourceList:\n        - 'unix:///var/lib/amqtt/aminer.sock'\n        - 'unix:///var/lib/akafka/aminer.sock'\n        #- 'file:///home/ubuntu/uplinkframes.log'\n        #- 'file:///home/ubuntu/weblogs.log'\n        #- 'file:///home/ubuntu/data/wobcom-web-attack.log'\n        #- 'file:///home/ubuntu/data/wobcom-web-apache.log'\n        #- 'file:///home/ubuntu/data/casting-weblogs-train.txt'\n        #- 'file:///home/ubuntu/data/chirpstack.logs'\n        #- 'file:///home/ubuntu/data/chirpstack-train.logs'\n        #- 'file:///home/ubuntu/data/test.txt'\n        #- 'file:///home/ubuntu/data/casting-01-weblogs.txt'\n        #- 'file:///home/ubuntu/data/casting-01-chirpstack.logs'\n        #- 'file:///home/ubuntu/data/casting-weblogs-apache.txt'\n        #- 'file:///home/ubuntu/data/wobcom-web-train.log'\n        #- 'file:///home/ubuntu/data/demo.log'\n        #- 'file:///home/ubuntu/data/train.log'\nParser:\n        - id: index_model\n          type: VariableByteDataModelElement\n          name: 'index'\n          args: ' !\"#$%&*+,-./0123456789:;<>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\\\]^_`abcdefghijklmnopqrstuvwxyz{|}~'\n        - id: type_model\n          type: VariableByteDataModelElement\n          name: 'type'\n          args: ' !\"#$%&*+,-./0123456789:;<>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\\\]^_`abcdefghijklmnopqrstuvwxyz{|}~'\n        - id: id_model\n          type: VariableByteDataModelElement\n          name: 'id'\n          args: ' !\"#$%&*+,-./0123456789:;<>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\\\]^_`abcdefghijklmnopqrstuvwxyz{|}~'\n        - id: message_model\n          type: VariableByteDataModelElement\n          name: 'message'\n          args: ' !\"#$%&*+,-./0123456789:;<>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\\\]^_`abcdefghijklmnopqrstuvwxyz{|}~'\n        - id: score_model_float\n          type: DecimalFloatValueModelElement\n          name: 'score_message'\n        - id: score_model_null\n          type: FixedDataModelElement\n          name: 'score_null'\n          args: 'null'\n        - id: score_model\n          type: FirstMatchModelElement\n          name: 'score'\n          args:\n            - score_model_float\n            - score_model_null\n        - id: pid_model\n          type: DecimalIntegerValueModelElement\n          name: 'pid'\n        - id: g12id_model\n          type: DecimalIntegerValueModelElement\n          name: 'g12id'\n        - id: uid_model\n          type: DecimalIntegerValueModelElement\n          name: 'uid'\n        - id: level_model\n          type: DecimalIntegerValueModelElement\n          name: 'level'\n        - id: ip_model\n          type: IpAddressDataModelElement\n          name: 'ip'\n        - id: port_model\n          type: DecimalIntegerValueModelElement\n          name: 'port'\n        - id: streams_model\n          type: VariableByteDataModelElement\n          name: 'streams'\n          args: ' !\"#$%&*+,-./0123456789:;<>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\\\]^_`abcdefghijklmnopqrstuvwxyz{|}~'\n        - id: g12s_model\n          type: VariableByteDataModelElement\n          name: 'g12s'\n          args: ' !\"#$%&*+,-./0123456789:;<>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\\\]^_`abcdefghijklmnopqrstuvwxyz{|}~'\n        - id: appname_model\n          type: VariableByteDataModelElement\n          name: 'appname'\n          args: ' !\"#$%&*+,-./0123456789:;<>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\\\]^_`abcdefghijklmnopqrstuvwxyz{|}~'\n        - id: facilityn_model\n          type: DecimalIntegerValueModelElement\n          name: 'facilityn'\n        - id: g12n_model\n          type: VariableByteDataModelElement\n          name: 'g12n'\n          args: ' !\"#$%&*+,-./0123456789:;<>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\\\]^_`abcdefghijklmnopqrstuvwxyz{|}~'\n        - id: facility_model\n          type: VariableByteDataModelElement\n          name: 'facility'\n          args: ' !\"#$%&*+,-./0123456789:;<>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\\\]^_`abcdefghijklmnopqrstuvwxyz{|}~'\n        - id: timestamp_model\n          type: DateTimeModelElement\n          name: 'timestamp'\n          date_format: '%Y-%m-%d %H:%M:%S.%f'\n        - id: sort_model\n          type: DecimalIntegerValueModelElement\n          name: 'sort'\n        - id: gateway_model\n          type: VariableByteDataModelElement\n          name: 'gateway_id'\n          args: ' !\"#$%&*+,-./0123456789:;<>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\\\]^_`abcdefghijklmnopqrstuvwxyz{|}~='\n        - id: string_model\n          type: VariableByteDataModelElement\n          name: 'string'\n          args: ' !\"#$%&*+,-./0123456789:;<>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\\\]^_`abcdefghijklmnopqrstuvwxyz{|}~='\n        - id: payload_model\n          type: VariableByteDataModelElement\n          name: 'string'\n          args: ' !\"#$%&*+,-./0123456789:;<>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\\\]^_`abcdefghijklmnopqrstuvwxyz{|}~='\n        - id: freq_model\n          type: DecimalIntegerValueModelElement\n          name: 'frequency'\n          value_sign_type: 'optional'\n        - id: int_model\n          type: DecimalIntegerValueModelElement\n          name: 'int'\n          value_sign_type: 'optional'\n        - id: float_model\n          type: DecimalFloatValueModelElement\n          name: 'float'\n          value_sign_type: 'optional'\n        - id: null_model\n          type: FixedDataModelElement\n          name: 'null'\n          args: 'null'\n        - id: none_model\n          type: FixedDataModelElement\n          name: 'None'\n          args: 'None'\n        - id: nn_model\n          type: FirstMatchModelElement\n          name: 'nn'\n          args:\n            - null_model\n            - none_model\n        - id: space\n          type: FixedDataModelElement\n          name: 'space'\n          args: ' '\n        #- id: http_model\n        #  type: HTTPLogModel\n        #  name: 'http'\n        - id: ts\n          type: DateTimeModelElement\n          name: 'ts'\n          date_format: '[%Y-%m-%dT%H:%M:%S.%fZ] '\n        - id: floatts_float\n          type: DateTimeModelElement\n          name: 'floatts'\n          date_format: '%s.%f'\n        - id: floatts_int\n          type: DateTimeModelElement\n          name: 'floatts'\n          date_format: '%s'\n        - id: floatts_model\n          type: FirstMatchModelElement\n          name: \"floatts\"\n          args:\n            - floatts_float\n            - floatts_int\n        - id: method\n          type: DelimitedDataModelElement\n          name: 'method'\n          #args: '0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ.:-/()[]{}!$%=<?*+_\\\\\"'\n          delimiter: ' '\n          consume_delimiter: true\n        - id: apistr\n          type: FixedDataModelElement\n          name: 'apistr'\n          args: '/api/internal/search?search='\n        - id: apirequest\n          type: DelimitedDataModelElement\n          name: 'request'\n          delimiter: '&limit='\n          consume_delimiter: false\n        - id: limit\n          type: DelimitedDataModelElement\n          name: 'limit'\n          delimiter: ' '\n          consume_delimiter: false\n        - id: otherrequest\n          type: DelimitedDataModelElement\n          name: 'otherrequest'\n          delimiter: ' '\n          consume_delimiter: false\n        - id: api\n          type: SequenceModelElement\n          name: 'api'\n          args:\n            - apistr\n            - apirequest\n            - limit\n        - id: request\n          type: FirstMatchModelElement\n          name: 'request'\n          args:\n            - api\n            - otherrequest\n        - id: remainder\n          type: DelimitedDataModelElement\n          name: 'http_remainder'\n          #args: '0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ.:-/()[]{}!$%=<?*+_\\\\\"'\n          delimiter: '\\n'\n          consume_delimiter: true\n        - id: stuff\n          type: DelimitedDataModelElement\n          name: 'stuff'\n          delimiter: ' '\n          consume_delimiter: true\n        - id: host\n          type: DelimitedDataModelElement\n          name: 'host'\n          delimiter: '\"'\n          consume_delimiter: false\n        - id: quotes\n          type: FixedDataModelElement\n          name: 'quotes'\n          args: '\"'\n        - id: apache\n          type: SequenceModelElement\n          name: 'http'\n          args:\n            - ts\n            - method\n            - request\n            - space\n            - stuff\n            - stuff\n            - stuff\n            - stuff\n            - stuff\n            - stuff\n            - stuff\n            - stuff\n            - stuff\n            - stuff\n            - quotes\n            - host\n            - remainder\n              #- method\n              #- request\n              #- remainder\n        - id: other_line\n          type: DelimitedDataModelElement\n          name: 'other'\n          delimiter: '\\n'\n          consume_delimiter: true\n        - id: empty_line\n          type: FixedDataModelElement\n          name: 'newline'\n          args: '\\n'\n        - id: whatever_line\n          type: VariableByteDataModelElement\n          name: 'whatever'\n          args: '0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ.:-/()[]{}!$%=<?*+_\\\\\" '\n        - id: http_model2\n          type: FirstMatchModelElement\n          name: 'log'\n          args:\n            - apache\n            - empty_line\n            - other_line\n            - whatever_line\n        - id: any\n          type: AnyByteDataModelElement\n          name: 'any'\n        - id: model\n          start: True\n          type: JsonModelElement\n          name: 'parser'\n          optional_key_prefix: '_'\n          key_parser_dict:\n            \"_phy_payload\": payload_model\n            \"_tx_info\":\n              \"_frequency\": freq_model\n              \"_gateway_id\": ALLOW_ALL\n              \"_power\": ALLOW_ALL\n              \"_board\": ALLOW_ALL\n              \"_timing\": ALLOW_ALL\n              \"_context\": ALLOW_ALL\n              \"_TimingInfo\":\n                \"_DelayTimingInfo\":\n                  \"_delay\":\n                    \"_seconds\": ALLOW_ALL\n              \"_ModulationInfo\":\n                \"_LoraModulationInfo\":\n                  \"_bandwidth\": int_model\n                  \"_spreading_factor\": int_model\n                  \"_code_rate\": string_model\n                  \"_polarization_inversion\": ALLOW_ALL\n            \"_rx_info\":\n              \"_gateway_id\": gateway_model\n              \"_time\":\n                \"_seconds\": int_model\n                \"_nanos\": int_model\n              \"_time_since_gps_epoch\":\n                \"_seconds\": int_model\n                \"_nanos\": int_model\n              \"_rssi\": int_model\n              \"_lora_snr\": float_model\n              \"_channel\": int_model\n              \"_board\": int_model\n              \"_rf_chain\": int_model\n              \"_location\":\n                \"_latitude\": float_model\n                \"_longitude\": float_model\n                \"_altitude\": int_model\n                \"_source\": int_model\n              \"_FineTimestamp\": nn_model\n              \"_context\": string_model\n              \"_uplink_id\": string_model\n              \"_crc_status\": int_model\n            \"_gateway_id\": ALLOW_ALL\n            \"_ip\": ALLOW_ALL\n            \"_stats_id\": ALLOW_ALL\n            \"_applicationID\": ALLOW_ALL\n            \"_applicationName\": ALLOW_ALL\n            \"_deviceName\": ALLOW_ALL\n            \"_devEUI\": ALLOW_ALL\n            \"_rxInfo\":\n              - ALLOW_ALL\n            \"_txInfo\":\n              \"_frequency\": ALLOW_ALL\n              \"_dr\": ALLOW_ALL\n            \"_adr\": ALLOW_ALL\n            \"_fCnt\": ALLOW_ALL\n            \"_fPort\": ALLOW_ALL\n            \"_data\": ALLOW_ALL\n            \"_token\": ALLOW_ALL\n            \"_downlink_id\": ALLOW_ALL\n            \"_items\":\n              - ALLOW_ALL\n            \"_tx_packets_received\": ALLOW_ALL\n            \"_tx_packets_emitted\": ALLOW_ALL\n            \"_margin\": ALLOW_ALL\n            \"_externalPowerSource\": ALLOW_ALL\n            \"_batteryLevel\": ALLOW_ALL\n            \"_batteryLevelUnavailable\": ALLOW_ALL\n            \"_type\": ALLOW_ALL\n            \"_error\": ALLOW_ALL\n            \"_rx_packets_received\": ALLOW_ALL\n            \"_rx_packets_received_ok\": ALLOW_ALL\n            \"_@timestamp\": floatts_model\n            \"_timestamp\": timestamp_model\n            \"_log\": http_model2\n            \"_stream\": ALLOW_ALL\n            \"_level\": ALLOW_ALL\n            \"_msg\": ALLOW_ALL\n            \"_message\": ALLOW_ALL\n            \"_time\": ALLOW_ALL\n            \"_kubernetes\":\n              \"_pod_name\": ALLOW_ALL\n              \"_namespace_name\": ALLOW_ALL\n              \"_pod_id\": ALLOW_ALL\n              \"_labels\":\n                \"_app\": ALLOW_ALL\n                \"_chart\": ALLOW_ALL\n                \"_heritage\": ALLOW_ALL\n                \"_install.operator.istio.io/owning-resource\": ALLOW_ALL\n                \"_istio\": ALLOW_ALL\n                \"_istio.io/rev\": ALLOW_ALL\n                \"_operator.istio.io/component\": ALLOW_ALL\n                \"_pod-template-hash\": ALLOW_ALL\n                \"_release\": ALLOW_ALL\n                \"_service.istio.io/canonical-name\": ALLOW_ALL\n                \"_service.istio.io/canonical-revision\": ALLOW_ALL\n                \"_sidecar.istio.io/inject\": ALLOW_ALL\n                \"_controller-revision-hash\": ALLOW_ALL\n                \"_k8s-app\": ALLOW_ALL\n                \"_pod-template-generation\": ALLOW_ALL\n                \"_app.kubernetes.io/instance\": ALLOW_ALL\n                \"_app.kubernetes.io/managed-by\": ALLOW_ALL\n                \"_app.kubernetes.io/name\": ALLOW_ALL\n                \"_statefulset.kubernetes.io/pod-name\": ALLOW_ALL\n                \"_addonmanager.kubernetes.io/mode\": ALLOW_ALL\n                \"_kubernetes.io/cluster-service\": ALLOW_ALL\n                \"_app.kubernetes.io/version\": ALLOW_ALL\n                \"_app.kubernetes.io/component\": ALLOW_ALL\n                \"_application\": ALLOW_ALL\n                \"_cluster-name\": ALLOW_ALL\n                \"_spilo-role\": ALLOW_ALL\n                \"_team\": ALLOW_ALL\n                \"_app.kubernetes.io/part-of\": ALLOW_ALL\n                \"_name\": ALLOW_ALL\n                \"_helm.sh/chart\": ALLOW_ALL\n                \"_role\": ALLOW_ALL\n                \"_control-plane\": ALLOW_ALL\n                \"_prometheus\": ALLOW_ALL\n                \"_jobLabel\": ALLOW_ALL\n              \"_annotations\":\n                \"_cni.projectcalico.org/podIP\": ALLOW_ALL\n                \"_prometheus.io/path\": ALLOW_ALL\n                \"_prometheus.io/port\": ALLOW_ALL\n                \"_prometheus.io/scrape\": ALLOW_ALL\n                \"_sidecar.istio.io/inject\": ALLOW_ALL\n                \"_checksum/config\": ALLOW_ALL\n                \"_checksum/config-emails\": ALLOW_ALL\n                \"_checksum/google-secret\": ALLOW_ALL\n                \"_checksum/secret\": ALLOW_ALL\n                \"_scheduler.alpha.kubernetes.io/critical-pod\": ALLOW_ALL\n                \"_checksum/luascripts\": ALLOW_ALL\n                \"_checksum/repositories\": ALLOW_ALL\n                \"_checksum/sc-dashboard-provider-config\": ALLOW_ALL\n                \"_checksum/dashboards-json-config\": ALLOW_ALL\n                \"_status\": ALLOW_ALL\n                \"_kubectl.kubernetes.io/restartedAt\": ALLOW_ALL\n              \"_host\": ALLOW_ALL\n              \"_container_name\": ALLOW_ALL\n              \"_docker_id\": ALLOW_ALL\n              \"_container_hash\": ALLOW_ALL\n              \"_container_image\": ALLOW_ALL\nInput:\n        json_format: True\n        multi_source: False\n        timestamp_paths:\n          - \"/parser/timestamp\"\n          - \"/parser/floatts/floatts\"\nAnalysis:\n        - type: 'ParserCount'\n          #paths:\n                  #- \"/parser/accesslog/fm/seq/path\"\n                  #- '/parser/accesslog/time_model/time'\n                  #- '/parser/rx_info/gateway_id'\n          report_interval: 10\n          output_event_handlers:\n         #   - statusq\n            - stpe\n        - type: 'CharsetDetector'\n          paths:\n            - \"/parser/log/http/request/api/request\"\n          learn_mode: False\n          output_logline: True #False\n          output_event_handlers:\n            - mqe\n            - stpe\n        - type: 'EntropyDetector'\n          paths:\n            - \"/parser/log/http/request/api/request\"\n          prob_thresh: 0.03\n          learn_mode: False\n          output_logline: True #False\n          output_event_handlers:\n            - mqe\n            - stpe\n          #- type: 'NewMatchPathValueDetector'\n          #id: 'Gateway_ID_value'\n          #persistence_id: 'Gateway_ID'\n          #paths: [\"/parser/rx_info/gateway_id\"]\n          #learn_mode: True\n          # - type: 'NewMatchPathValueDetector'\n          #id: 'Test'\n          #persistence_id: 'test'\n          #paths: [\"/parser/log\"]\n          #learn_mode: True\n        - type: 'ValueRangeDetector'\n          paths: [\"/parser/tx_info/frequency\"]\n          persistence_id: 'Frequency'\n          output_logline: True #False\n          learn_mode: False\n          #- type: 'NewMatchPathValueComboDetector'\n          #persistence_id: 'Combo_request'\n          #paths:\n          #  - \"/parser/accesslog/fm/seq/path\"\n          #  - \"/parser/accesslog/method\"\n          #learn_mode: True\n        - type: 'NewMatchPathDetector'\n          id: 'nmpd'\n          output_logline: True #False\n          learn_mode: True\n          suppress: true\n        - type: 'VerboseUnparsedAtomHandler'\n          id: 'suah'\n          suppress: false #true\nEventHandlers:\n        - id: \"stpe\"\n          json: true\n          type: \"StreamPrinterEventHandler\"\n        - id: 'mqe'\n          json: True\n          topic: 'aminer-alerts' # 'aminer' # aminer-alerts\n          cfgfile: '/etc/kafka/kafka-client.conf'\n          type: 'KafkaEventHandler'\n        #- id: 'statusq'\n        #  json: True\n        #  topic: 'aminer'\n        #  cfgfile: '/etc/aminer/kafka-client.conf'\n        #  type: 'KafkaEventHandler'\n"
                }
            ]
        }
    ]
}
