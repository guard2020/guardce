package eu.smartcontroller.guard.demo.model.securityPolicies;

public class TotalVulnerabilityScore {

    private float quantitativeTotalVulnerabilityScore;
    private String qualitativeTotalVulnerabilityScore;
    private String origin;
    private String description;

    public TotalVulnerabilityScore()
    {
    }

    public TotalVulnerabilityScore(float quantitativeTotalVulnerabilityScore, String qualitativeTotalVulnerabilityScore) {
        this.quantitativeTotalVulnerabilityScore = quantitativeTotalVulnerabilityScore;
        this.qualitativeTotalVulnerabilityScore = qualitativeTotalVulnerabilityScore;
        this.origin = "RiskAssessment";
        this.description = "Qualitative and quantitative risk";
    }

    public float getQuantitativeTotalVulnerabilityScore() {
        return quantitativeTotalVulnerabilityScore;
    }

    public void setQuantitativeTotalVulnerabilityScore(float quantitativeTotalVulnerabilityScore) {
        this.quantitativeTotalVulnerabilityScore = quantitativeTotalVulnerabilityScore;
    }

    public String getQualitativeTotalVulnerabilityScore() {
        return qualitativeTotalVulnerabilityScore;
    }

    public void setQualitativeTotalVulnerabilityScore(String qualitativeTotalVulnerabilityScore) {
        this.qualitativeTotalVulnerabilityScore = qualitativeTotalVulnerabilityScore;
    }

    public String getOrigin() {
        return origin;
    }

    public void setOrigin(String origin) {
        this.origin = origin;
    }

    public String getDescription() {
        return description;
    }

    public void setDescription(String description) {
        this.description = description;
    }

    @Override
    public String toString() {
        return "TotalVulnerabilityScore{" +
                "quantitativeTotalVulnerabilityScore=" + quantitativeTotalVulnerabilityScore +
                ", qualitativeTotalVulnerabilityScore='" + qualitativeTotalVulnerabilityScore + '\'' +
                ", source='" + origin + '\'' +
                ", description='" + description + '\'' +
                '}';
    }

    // we will not use this method. Qualitative vulnerability score will be decoupled by the quantitative one.
    public String calculateTotalQualitativeVulnerabilityScore(float quantitativeTotalVulnerabilityScore) {
        switch ((0 <= quantitativeTotalVulnerabilityScore && quantitativeTotalVulnerabilityScore <= 3.9 ) ? 0 :
                (4 <= quantitativeTotalVulnerabilityScore && quantitativeTotalVulnerabilityScore <= 6.9 ) ? 1 :
                        (7 <= quantitativeTotalVulnerabilityScore && quantitativeTotalVulnerabilityScore <= 8.9 ) ? 2 :
                (9 <= quantitativeTotalVulnerabilityScore && quantitativeTotalVulnerabilityScore <= 10) ? 3 : 4) {
            case 0:
                this.setQualitativeTotalVulnerabilityScore("Low");
                break;
            case 1:
                this.setQualitativeTotalVulnerabilityScore("Medium");
                break;
            case 2:
                this.setQualitativeTotalVulnerabilityScore("High");
                break;
            case 3:
                this.setQualitativeTotalVulnerabilityScore("Critical");
                break;
            case 4:
                this.setQualitativeTotalVulnerabilityScore("Out of bounds");
        }
        return "QualitativeVulnerabilityScore calculated successfully";
    }
}
